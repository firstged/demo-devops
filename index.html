<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <!-- Viewport essentiel pour le mobile : emp√™che le zoom et adapte la taille -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>La Lettre Secr√®te - Ultimate</title>
    <style>
        :root {
            --bg-gradient-start: #fdfbfb;
            --bg-gradient-end: #ebedee;
            --primary: #6366f1;
            /* Indigo moderne */
            --primary-dark: #4f46e5;
            --secondary: #ec4899;
            /* Pink pour le fun */
            --text: #1e293b;
            --glass: rgba(255, 255, 255, 0.90);
            --success: #22c55e;
            --error: #ef4444;
            --gold: #fbbf24;
            --silver: #94a3b8;
            --bronze: #b45309;
        }

        * {
            box-sizing: border-box;
            user-select: none;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
            color: var(--text);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        /* --- FOND ANIM√â --- */
        .bubbles-container {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .bubble {
            position: absolute;
            bottom: -50px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgba(255, 255, 255, 0.8);
            font-weight: bold;
            animation: floatUp linear infinite;
        }

        @keyframes floatUp {
            to {
                transform: translateY(-120vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* --- CONTENEUR PRINCIPAL --- */
        .app-container {
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 500px;
            height: 100%;
            max-height: 900px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 1rem;
        }

        .card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 2rem;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1);
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* --- TYPOGRAPHIE --- */
        h1 {
            margin: 0;
            font-size: 1.8rem;
            color: var(--primary);
            letter-spacing: -1px;
        }

        .subtitle {
            color: #64748b;
            margin-top: -10px;
            font-size: 0.9rem;
        }

        /* --- √âCRANS (Start, Game, End) --- */
        .screen {
            display: none;
            flex-direction: column;
            gap: 1.5rem;
            height: 100%;
            justify-content: center;
        }

        .screen.active {
            display: flex;
        }

        /* --- INPUTS & BOUTONS --- */
        input[type="text"] {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            text-align: center;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            outline: none;
            transition: 0.3s;
            background: white;
        }

        input:focus {
            border-color: var(--primary);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            border: none;
            padding: 16px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
            transition: transform 0.1s;
            width: 100%;
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        /* --- JEU UI --- */
        .stats-bar {
            display: flex;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.6);
            padding: 10px 15px;
            border-radius: 12px;
            font-weight: 700;
            color: var(--text);
        }

        .hint-display {
            font-size: 1.4rem;
            font-weight: 800;
            padding: 2rem;
            background: white;
            border-radius: 16px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
            color: var(--primary);
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 5px;
        }

        .hint-sub {
            font-size: 0.8rem;
            color: #94a3b8;
            font-weight: normal;
        }

        .game-input-group {
            display: flex;
            gap: 10px;
        }

        .letter-input {
            width: 70px !important;
            height: 70px;
            font-size: 2.5rem !important;
            font-weight: 900;
            text-transform: uppercase;
            color: var(--primary);
        }

        /* --- LEADERBOARD --- */
        .leaderboard-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 250px;
            overflow-y: auto;
            background: white;
            border-radius: 12px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.9rem;
        }

        .score-item:last-child {
            border-bottom: none;
        }

        .rank-badge {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #e2e8f0;
            color: #64748b;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 10px;
        }

        .rank-1 .rank-badge {
            background: var(--gold);
            color: white;
        }

        .rank-2 .rank-badge {
            background: var(--silver);
            color: white;
        }

        .rank-3 .rank-badge {
            background: var(--bronze);
            color: white;
        }

        .player-info {
            display: flex;
            align-items: center;
            text-align: left;
        }

        .player-title {
            font-size: 0.7rem;
            color: var(--secondary);
            display: block;
        }

        /* --- ANIMATIONS --- */
        .pop {
            animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes pop {
            50% {
                transform: scale(1.1);
            }
        }

        .shake {
            animation: shake 0.4s;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }
        }

        /* --- RESPONSIVE MOBILE --- */
        @media (max-width: 480px) {
            .card {
                padding: 1.5rem;
                gap: 1rem;
            }

            h1 {
                font-size: 1.5rem;
            }

            .hint-display {
                font-size: 1.1rem;
                padding: 1.5rem;
            }

            .letter-input {
                width: 60px !important;
                height: 60px;
                font-size: 2rem !important;
            }
        }
    </style>
</head>

<body>

    <div class="bubbles-container" id="bubbles"></div>

    <div class="app-container">

        <!-- √âCRAN 1 : ACCUEIL -->
        <div id="screen-home" class="screen card active">
            <div>
                <h1>La Lettre Secr√®te</h1>
                <p class="subtitle">Ultimate Edition</p>
            </div>
            <div style="font-size: 4rem;">üïµÔ∏è‚Äç‚ôÄÔ∏è</div>
            <p>Entre ton pseudo pour rejoindre l'√©lite des devins.</p>
            <input type="text" id="username" placeholder="Ton Pseudo (ex: Neo)" maxlength="10">
            <button class="btn-primary" onclick="startGame()">COMMENCER L'AVENTURE</button>
        </div>

        <!-- √âCRAN 2 : JEU -->
        <div id="screen-game" class="screen card">
            <div class="stats-bar">
                <span>‚≠ê <span id="score">0</span></span>
                <span>‚ù§Ô∏è <span id="lives">3</span></span>
            </div>

            <div id="hint-box" class="hint-display">
                <span id="hint-text">Chargement...</span>
                <span id="hint-sub" class="hint-sub">Trouve la lettre</span>
            </div>

            <div class="game-input-group">
                <input type="text" id="guess" class="letter-input" maxlength="1" placeholder="?">
                <button class="btn-primary" onclick="submitGuess()" style="width: auto; flex-grow: 1;">OK</button>
            </div>
        </div>

        <!-- √âCRAN 3 : GAME OVER & CLASSEMENT -->
        <div id="screen-end" class="screen card">
            <div>
                <h1 style="color: var(--text)">Partie Termin√©e</h1>
                <p class="subtitle">Bien jou√© <span id="end-player-name"></span> !</p>
            </div>

            <div style="background: #f8fafc; padding: 1rem; border-radius: 12px;">
                <div style="font-size: 0.9rem; color: #64748b;">SCORE FINAL</div>
                <div style="font-size: 3rem; font-weight: 800; color: var(--primary);" id="end-score">0</div>
            </div>

            <div style="text-align: left; width: 100%;">
                <h4 style="margin: 0 0 10px 0;">üèÜ Top 10 L√©gendaire</h4>
                <ul id="leaderboard" class="leaderboard-list">
                    <!-- Scores ins√©r√©s par JS -->
                </ul>
            </div>

            <button class="btn-primary" onclick="resetGame()">REJOUER</button>
        </div>

    </div>

    <script>
        /* --- CONFIGURATION --- */
        const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        let gameState = {
            username: "Joueur",
            score: 0,
            lives: 3, // Vies par manche
            secret: "",
            history: [] // Pour √©viter de retomber sur la m√™me lettre tout de suite
        };

        // DOM Elements
        const screens = {
            home: document.getElementById('screen-home'),
            game: document.getElementById('screen-game'),
            end: document.getElementById('screen-end')
        };
        const els = {
            username: document.getElementById('username'),
            score: document.getElementById('score'),
            lives: document.getElementById('lives'),
            hintText: document.getElementById('hint-text'),
            hintSub: document.getElementById('hint-sub'),
            guess: document.getElementById('guess'),
            hintBox: document.getElementById('hint-box'),
            endPlayer: document.getElementById('end-player-name'),
            endScore: document.getElementById('end-score'),
            leaderboard: document.getElementById('leaderboard')
        };

        /* --- NAVIGATION --- */
        function showScreen(name) {
            Object.values(screens).forEach(s => s.classList.remove('active'));
            screens[name].classList.add('active');
        }

        /* --- GAMEPLAY --- */
        function startGame() {
            const name = els.username.value.trim();
            if (!name) {
                alert("Choisis un pseudo !");
                return;
            }
            gameState.username = name;
            gameState.score = 0;
            gameState.history = [];
            showScreen('game');
            newRound();
        }

        function newRound() {
            // Reset des vies pour la manche
            gameState.lives = 3;
            updateUI();

            // Choix lettre (√©viter la r√©p√©tition imm√©diate)
            let newSecret;
            do {
                newSecret = alphabet[Math.floor(Math.random() * alphabet.length)];
            } while (gameState.history.includes(newSecret) && gameState.history.length < 20);

            gameState.secret = newSecret;
            gameState.history.push(newSecret);

            // Indice initial
            generateHint();

            els.guess.value = "";
            els.guess.focus();
        }

        function generateHint(lastGuess = null) {
            let hintLetter;
            let relation;

            if (lastGuess) {
                // Indice intelligent bas√© sur l'erreur
                relation = gameState.secret > lastGuess ? "apr√®s" : "avant";
                hintLetter = lastGuess;
            } else {
                // Indice al√©atoire au d√©but
                do {
                    hintLetter = alphabet[Math.floor(Math.random() * alphabet.length)];
                } while (hintLetter === gameState.secret);
                relation = gameState.secret > hintLetter ? "apr√®s" : "avant";
            }

            els.hintText.innerText = `C'est ${relation} ${hintLetter}`;
            els.hintSub.innerText = `Devine la lettre secr√®te`;
            els.hintBox.style.color = "var(--primary)";
        }

        function submitGuess() {
            const guess = els.guess.value.toUpperCase();
            if (!alphabet.includes(guess) || !guess) return;

            // VICTOIRE MANCHE
            if (guess === gameState.secret) {
                gameState.score += 10 + (gameState.lives * 5); // Bonus si trouv√© vite
                els.hintBox.style.color = "var(--success)";
                els.hintText.innerText = `BRAVO ! C'√©tait ${gameState.secret}`;
                els.hintSub.innerText = "+ Points bonus !";
                els.hintBox.classList.add('pop');

                setTimeout(() => {
                    els.hintBox.classList.remove('pop');
                    newRound();
                }, 1200);
            }
            // ERREUR
            else {
                gameState.lives--;
                updateUI();

                // Feedback visuel
                const card = document.querySelector('#screen-game');
                card.classList.remove('shake');
                void card.offsetWidth;
                card.classList.add('shake');

                if (gameState.lives <= 0) {
                    gameOver();
                } else {
                    generateHint(guess);
                    els.hintBox.style.color = "var(--error)";
                    els.guess.value = "";
                    els.guess.focus();
                }
            }
        }

        function updateUI() {
            els.score.innerText = gameState.score;
            // Affiche les coeurs
            els.lives.innerText = "‚ù§Ô∏è".repeat(gameState.lives);
        }

        function gameOver() {
            saveScore(gameState.username, gameState.score);
            els.endPlayer.innerText = gameState.username;
            els.endScore.innerText = gameState.score;
            renderLeaderboard();
            showScreen('end');
        }

        function resetGame() {
            showScreen('home');
        }

        /* --- LEADERBOARD SYSTEM (Simulation LocalStorage) --- */
        // Titres bas√©s sur le rang
        const getTitle = (rank) => {
            if (rank === 0) return "üëë Boss des Secrets";
            if (rank === 1) return "‚öîÔ∏è Devin Supr√™me";
            if (rank === 2) return "üîÆ Oracle";
            if (rank < 5) return "üß† Grand Esprit";
            return "üê£ Apprenti";
        }

        function getLeaderboard() {
            const stored = localStorage.getItem('devops_game_scores');
            if (stored) return JSON.parse(stored);

            // Donn√©es initiales (Fake players pour motiver)
            return [
                { name: "AlphaDev", score: 500 },
                { name: "DockerKing", score: 320 },
                { name: "GitMaster", score: 150 }
            ];
        }

        function saveScore(name, score) {
            let scores = getLeaderboard();
            scores.push({ name, score });
            // Tri d√©croissant
            scores.sort((a, b) => b.score - a.score);
            // Garder Top 10
            scores = scores.slice(0, 10);
            localStorage.setItem('devops_game_scores', JSON.stringify(scores));
        }

        function renderLeaderboard() {
            const scores = getLeaderboard();
            els.leaderboard.innerHTML = scores.map((s, index) => `
                <li class="score-item rank-${index + 1}">
                    <div class="player-info">
                        <span class="rank-badge">${index + 1}</span>
                        <div>
                            <strong>${s.name}</strong>
                            <span class="player-title">${getTitle(index)}</span>
                        </div>
                    </div>
                    <strong>${s.score} pts</strong>
                </li>
            `).join('');
        }

        /* --- BACKGROUND BUBBLES --- */
        function spawnBubble() {
            const b = document.createElement('div');
            b.className = 'bubble';
            const size = Math.random() * 40 + 20;
            b.style.width = size + 'px';
            b.style.height = size + 'px';
            b.style.left = Math.random() * 100 + '%';
            b.style.animationDuration = (Math.random() * 10 + 10) + 's';
            b.innerText = alphabet[Math.floor(Math.random() * 26)];
            document.getElementById('bubbles').appendChild(b);
            setTimeout(() => b.remove(), 20000);
        }
        setInterval(spawnBubble, 1000);
        for (let i = 0; i < 10; i++) spawnBubble();

        /* --- EVENTS --- */
        els.guess.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') submitGuess();
        });

    </script>
</body>

</html>